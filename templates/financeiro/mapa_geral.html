{% extends "base.html" %}
{% load humanize %}

{% block content %}
<style>
    /* Configura√ß√£o para Impress√£o */
    @media print {
        .no-print { display: none !important; }
        body { background: white; padding: 0; }
        .print-container { width: 100%; max-width: 100%; }
        table { border: 2px solid black; }
    }

    .print-container { font-family: Arial, sans-serif; color: black; margin: 20px auto; max-width: 1200px; }
    table { width: 100%; border-collapse: collapse; background: white; }
    th, td { border: 1.5px solid #000; padding: 6px; text-align: right; font-size: 13px; }
    .text-start { text-align: left !important; font-weight: bold; }

    /* Estiliza√ß√£o de Cores conforme a Imagem */
    .header-blue { background: #00b0f0; color: white; text-align: center; font-size: 20px; font-weight: bold; }
    .subheader-mapa { background: #00b0f0; font-weight: bold; text-align: center; }
    .subheader-yellow { background: #ffe699; font-weight: bold; text-align: center; }
    .week-dark { background: #3f4f63; color: white; font-weight: bold; text-align: center; }

    .row-green { background: #e2efda; }
    .total-green { background: #92d050; font-weight: bold; }
    .header-orange { background: #ed7d31; font-weight: bold; text-align: center; color: black; }
    .row-orange { background: #fff2cc; }
    .total-orange { background: #f4b084; font-weight: bold; }

    .label-blue { background: #00b0f0; color: white; }
    .val-yellow { background: #fff2cc; }
    .val-red { background: #ff6b6b; } /* Cor para a 3¬™ semana como na imagem */
    .total-final-green { background: #70ad47; font-weight: bold; }

    /* Filtros */
    .filter-bar { background: #f4f4f4; padding: 15px; border-radius: 5px; margin-bottom: 20px; display: flex; gap: 10px; align-items: flex-end; }
</style>

<div class="print-container">
    
    <form method="GET" class="filter-bar no-print">
        <div>
            <label>Setor:</label><br>
            <select name="sector">
                {% for s in sectores %}
                <option value="{{ s.id }}" {% if sector.id == s.id %}selected{% endif %}>{{ s.nome }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <label>M√™s:</label><br>
            <input type="number" name="mes" value="{{ mes }}" min="1" max="12">
        </div>
        <div>
            <label>Ano:</label><br>
            <input type="number" name="ano" value="{{ ano }}">
        </div>
        <button type="submit" style="background: #28a745; color: white; border: none; padding: 8px 15px; cursor: pointer;">Filtrar</button>
        <button type="button" onclick="window.print()" style="background: #6c757d; color: white; border: none; padding: 8px 15px; cursor: pointer;">üñ®Ô∏è Imprimir</button>
    </form>

    <table>
        <tr><th colspan="6" class="header-blue">{{ sector.nome|upper }}</th></tr>
        
        <tr>
            <td rowspan="2" class="subheader-mapa">CONTROLO FINANCEIRO<br>MAPA GERAL</td>
            <td colspan="4" class="subheader-yellow">DEZEMBRO / {{ ano }}</td>
            <td rowspan="2" class="subheader-mapa">TOTAL MENSAL</td>
        </tr>
        <tr>
            <td class="week-dark">1¬™ SEMANA</td>
            <td class="week-dark">2¬™ SEMANA</td>
            <td class="week-dark">3¬™ SEMANA</td>
            <td class="week-dark">4¬™ SEMANA</td>
        </tr>

        <tr class="row-green">
            <td class="text-start">DIARIA</td>
            <td>{{ semanas.1.entradas.normal|intcomma }}</td>
            <td>{{ semanas.2.entradas.normal|intcomma }}</td>
            <td>{{ semanas.3.entradas.normal|intcomma }}</td>
            <td>{{ semanas.4.entradas.normal|intcomma }}</td>
            <td>{{ total_entradas_normal|intcomma }}</td>
        </tr>
        <tr class="row-green">
            <td class="text-start">ALUNOS</td>
            <td>{{ semanas.1.entradas.alunos|intcomma }}</td>
            <td>{{ semanas.2.entradas.alunos|intcomma }}</td>
            <td>{{ semanas.3.entradas.alunos|intcomma }}</td>
            <td>{{ semanas.4.entradas.alunos|intcomma }}</td>
            <td>{{ total_entradas_alunos|intcomma }}</td>
        </tr>
        <tr class="row-green">
            <td class="text-start">LUVU</td>
            <td>{{ semanas.1.entradas.luvu|intcomma }}</td>
            <td>{{ semanas.2.entradas.luvu|intcomma }}</td>
            <td>{{ semanas.3.entradas.luvu|intcomma }}</td>
            <td>{{ semanas.4.entradas.luvu|intcomma }}</td>
            <td>{{ total_entradas_luvu|intcomma }}</td>
        </tr>
        <tr class="row-green">
            <td class="text-start">FRETE</td>
            <td>{{ semanas.1.entradas.frete|intcomma }}</td>
            <td>{{ semanas.2.entradas.frete|intcomma }}</td>
            <td>{{ semanas.3.entradas.frete|intcomma }}</td>
            <td>{{ semanas.4.entradas.frete|intcomma }}</td>
            <td>{{ total_entradas_frete|intcomma }}</td>
        </tr>
        <tr class="total-green">
            <td class="text-start">TOTAL</td>
            <td>{{ semanas.1.entradas.total|intcomma }}</td>
            <td>{{ semanas.2.entradas.total|intcomma }}</td>
            <td>{{ semanas.3.entradas.total|intcomma }}</td>
            <td>{{ semanas.4.entradas.total|intcomma }}</td>
            <td>{{ total_entradas|intcomma }}</td>
        </tr>

        <tr><td colspan="6" class="header-orange">DESPESAS FIXAS</td></tr>
        <tr class="row-orange">
            <td class="text-start">ALIMENTA√á√ÉO</td>
            <td>{{ semanas.1.despesas.alimentacao|intcomma }}</td>
            <td>{{ semanas.2.despesas.alimentacao|intcomma }}</td>
            <td>{{ semanas.3.despesas.alimentacao|intcomma }}</td>
            <td>{{ semanas.4.despesas.alimentacao|intcomma }}</td>
            <td>{{ total_despesas_alimentacao|intcomma }}</td>
        </tr>
        <tr class="row-orange">
            <td class="text-start">PARQUEAMENTO</td>
            <td>{{ semanas.1.despesas.parqueamento|intcomma }}</td>
            <td>{{ semanas.2.despesas.parqueamento|intcomma }}</td>
            <td>{{ semanas.3.despesas.parqueamento|intcomma }}</td>
            <td>{{ semanas.4.despesas.parqueamento|intcomma }}</td>
            <td>{{ total_despesas_parqueamento|intcomma }}</td>
        </tr>
        <tr class="row-orange">
            <td class="text-start">TAXAS</td>
            <td>{{ semanas.1.despesas.taxa|intcomma }}</td>
            <td>{{ semanas.2.despesas.taxa|intcomma }}</td>
            <td>{{ semanas.3.despesas.taxa|intcomma }}</td>
            <td>{{ semanas.4.despesas.taxa|intcomma }}</td>
            <td>{{ total_despesas_taxa|intcomma }}</td>
        </tr>
        <tr class="row-orange">
            <td class="text-start">COMBUST√çVEL</td>
            <td>{{ semanas.1.despesas.combustivel|intcomma }}</td>
            <td>{{ semanas.2.despesas.combustivel|intcomma }}</td>
            <td>{{ semanas.3.despesas.combustivel|intcomma }}</td>
            <td>{{ semanas.4.despesas.combustivel|intcomma }}</td>
            <td>{{ total_despesas_combustivel|intcomma }}</td>
        </tr>
        <tr class="row-orange">
            <td class="text-start">LAVAGEM</td>
            <td>{{ semanas.1.despesas.lavagem|intcomma }}</td>
            <td>{{ semanas.2.despesas.lavagem|intcomma }}</td>
            <td>{{ semanas.3.despesas.lavagem|intcomma }}</td>
            <td>{{ semanas.4.despesas.lavagem|intcomma }}</td>
            <td>{{ total_despesas_lavagem|intcomma }}</td>
        </tr>
        <tr class="row-orange">
            <td class="text-start">SOPRAGEM</td>
            <td>{{ semanas.1.despesas.sopragem|intcomma }}</td>
            <td>{{ semanas.2.despesas.sopragem|intcomma }}</td>
            <td>{{ semanas.3.despesas.sopragem|intcomma }}</td>
            <td>{{ semanas.4.despesas.sopragem|intcomma }}</td>
            <td>{{ total_despesas_sopragem|intcomma }}</td>
        </tr>
        <tr class="row-orange">
            <td class="text-start">OUTROS</td>
            <td>{{ semanas.1.despesas.outros|intcomma }}</td>
            <td>{{ semanas.2.despesas.outros|intcomma }}</td>
            <td>{{ semanas.3.despesas.outros|intcomma }}</td>
            <td>{{ semanas.4.despesas.outros|intcomma }}</td>
            <td>{{ total_despesas_outros|intcomma }}</td>
        </tr>
        <tr class="total-orange">
            <td class="text-start">TOTAL</td>
            <td>{{ semanas.1.despesas.total|intcomma }}</td>
            <td>{{ semanas.2.despesas.total|intcomma }}</td>
            <td>{{ semanas.3.despesas.total|intcomma }}</td>
            <td>{{ semanas.4.despesas.total|intcomma }}</td>
            <td>{{ total_despesas|intcomma }}</td>
        </tr>

        <tr>
            <td class="label-blue text-start">SALDO SEMANAL</td>
            <td class="val-yellow">{{ semanas.1.saldo|intcomma }}</td>
            <td class="val-yellow">{{ semanas.2.saldo|intcomma }}</td>
            <td class="val-red">{{ semanas.3.saldo|intcomma }}</td>
            <td class="val-yellow">{{ semanas.4.saldo|intcomma }}</td>
            <td class="total-final-green">{{ saldo_liquido|intcomma }}</td>
        </tr>
    </table>
</div>
{% endblock %}
