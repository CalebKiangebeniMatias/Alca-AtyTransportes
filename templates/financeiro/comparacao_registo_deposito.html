{% extends "base.html" %}
{% load humanize %}

{% block content %}

	<h3 class="mb-4">üìä Compara√ß√£o Registo vs Dep√≥sito</h3>

	<form method="get" class="row mb-4">

		<div class="col-md-3">
			<label>Sector</label>
			<select name="sector" class="form-control">
				<option value="">Todos</option>
				{% for s in sectores %}
					<option value="{{ s.id }}" {% if sector_id == s.id|stringformat:"s" %}selected{% endif %}>
						{{ s.nome }}
					</option>
				{% endfor %}
			</select>
		</div>

		<div class="col-md-2">
			<label>Ano</label>
			<select name="year" class="form-control">
				<option value="2025" {% if year == 2025 %}selected{% endif %}>2025</option>
				<option value="2026" {% if year == 2026 %}selected{% endif %}>2026</option>
				<option value="2027" {% if year == 2027 %}selected{% endif %}>2027</option>
				<option value="2028" {% if year == 2028 %}selected{% endif %}>2028</option>
				<option value="2029" {% if year == 2029 %}selected{% endif %}>2029</option>
			</select>
		</div>

		<div class="col-md-2">
			<label>M√™s</label>
			<select name="month" class="form-control">
				<option value="1" {% if month == 1 %}selected{% endif %}>Janeiro</option>
				<option value="2" {% if month == 2 %}selected{% endif %}>Fevereiro</option>
				<option value="3" {% if month == 3 %}selected{% endif %}>Mar√ßo</option>
				<option value="4" {% if month == 4 %}selected{% endif %}>Abril</option>
				<option value="5" {% if month == 5 %}selected{% endif %}>Maio</option>
				<option value="6" {% if month == 6 %}selected{% endif %}>Junho</option>
				<option value="7" {% if month == 7 %}selected{% endif %}>Julho</option>
				<option value="8" {% if month == 8 %}selected{% endif %}>Agosto</option>
				<option value="9" {% if month == 9 %}selected{% endif %}>Setembro</option>
				<option value="10" {% if month == 10 %}selected{% endif %}>Outubro</option>
				<option value="11" {% if month == 11 %}selected{% endif %}>Novembro</option>
				<option value="12" {% if month == 12 %}selected{% endif %}>Dezembro</option>
			</select>
		</div>

		<div class="col-md-2 align-self-end">
			<button class="btn btn-primary w-100">Filtrar</button>
		</div>

	</form>


	<div class="table-responsive">
		<table class="table table-bordered table-striped">
		<thead class="table-dark text-center">
			<tr>
			<th>Data</th>
			<th>Sector</th>
			<th>Entrada</th>
			<th>Sa√≠da</th>
			<th>Resto</th>
			<th>Depositado</th>
			<th>Diferen√ßa</th>
			</tr>
		</thead>
		<tbody class="text-center">
			{% for item in dados %}
			<tr>
			<td>{{ item.data|date:"d/m/Y" }}</td>
			<td>{{ item.sector.nome }}</td>
			<td>{{ item.entrada|intcomma }} kz</td>
			<td>{{ item.saida|intcomma }} kz</td>
			<td class="fw-bold">{{ item.resto|intcomma }} kz</td>
			<td>{{ item.depositado|intcomma }} kz</td>

			<td class="
				{% if item.diferenca > 500 or item.diferenca < -500 %}
				text-danger fw-bold
				{% else %}
				text-success
				{% endif %}
			">
				{{ item.diferenca|intcomma }} kz
			</td>
			</tr>
			{% empty %}
			<tr>
			<td colspan="7">Sem dados no per√≠odo selecionado.</td>
			</tr>
			{% endfor %}
		</tbody>

		<tfoot class="table-secondary text-center fw-bold">
			<tr>
			<td colspan="2">TOTAL</td>
			<td>{{ total_entrada|intcomma }} kz</td>
			<td>{{ total_saida|intcomma }} kz</td>
			<td>{{ total_resto|intcomma }} kz</td>
			<td>{{ total_depositado|intcomma }} kz</td>
			<td>{{ total_diferenca|intcomma }} kz</td>
			</tr>
		</tfoot>

		</table>
	</div>

{% endblock %}